<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Bible App</title>
  <link rel="icon" href="https://fav.farm/ðŸ“œ" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<!-- <link rel="stylesheet" href="./style.css"> -->

<style>
  html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow-y: auto;
}

body {
  background-color: var(--color-bkgd);
  transition: 0.2s ease;
}

#container {
  height: 200vh; /* 200% of the viewport height to ensure content exceeds the visible area */
}

  @font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/lora/v35/0QI6MX1D_JOuGQbT0gvTJPa787weuyJG.ttf) format('truetype');
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/lora/v35/0QI6MX1D_JOuGQbT0gvTJPa787zAvCJG.ttf) format('truetype');
}
@font-face {
  font-family: 'Work Sans';
  font-style: normal;
  font-weight: 300;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/worksans/v19/QGY_z_wNahGAdqQ43RhVcIgYT2Xz5u32KxfXNig.ttf) format('truetype');
}
@font-face {
  font-family: 'Work Sans';
  font-style: normal;
  font-weight: 500;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/worksans/v19/QGY_z_wNahGAdqQ43RhVcIgYT2Xz5u32K3vXNig.ttf) format('truetype');
}
@font-face {
  font-family: 'Work Sans';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url(https://fonts.gstatic.com/s/worksans/v19/QGY_z_wNahGAdqQ43RhVcIgYT2Xz5u32K67QNig.ttf) format('truetype');
}
:root {
  --color-main: #000000;
  --color-accent: #cfcfcf;
  --color-contrast: #000000;
  --color-body: #e2e2e2;
  --color-bkgd: #f8f8f8;
  --color-soft: #bbbbbb;
}
[data-theme="dark"] {
  --color-main: #c7c7c7;
  --color-accent: #343434;
  --color-contrast: #ffffff;
  --color-body: #101010;
  --color-bkgd: #000000;
  --color-soft: #636363;
}
ul {
  display: none;
  z-index: 10;
  list-style-type: none;
  margin-block-start: 0;
  margin-block-end: 0;
  padding-inline-start: 0;
  position: fixed;
  top: 0px;
  bottom: 0px;
  background-color: var(--color-bkgd);
  text-align: left;
  overflow-y: scroll;
  width: 100%;
  max-width: 740px;
  padding: 20px 60px;
  margin: 40px auto 0;
}
ul li.bookitem {
  display: block;
  font-family: "Lora";
  font-weight: 600;
  font-size: 20px;
  position: relative;
  border-bottom: 1px solid var(--color-accent);
  cursor: pointer;
  padding: 15px 0 5px;
  color: var(--color-main);
  transition: 0.2s ease;
}
ul li.bookitem:hover {
  border-bottom: 1px solid var(--color-main);
  color: var(--color-contrast);
}
ul li.chapteritem {
  display: inline-block;
  font-weight: 700;
  text-align: center;
  position: relative;
  width: 60px;
  height: 45px;
  margin: 2px;
  padding-top: 15px;
  border: 1px solid var(--color-accent);
  cursor: pointer;
  background: var(--color-bkgd);
  transition: 0.2s ease;
}
ul li.chapteritem:hover {
  background-color: var(--color-accent);
}
::-webkit-scrollbar {
  width: 8px; /* Adjust the width as needed */
}

::-webkit-scrollbar-thumb {
  background-color: var(--color-soft);
  border-radius: 4px;
}

::-webkit-scrollbar-track {
  background-color: var(--color-bkgd);
}

button.dismiss {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  border: none;
  background: var(--color-main);
  color: var(--color-bkgd);
  font-size: 26px;
  padding: 8px 0 6px;
  cursor: pointer;
  z-index: 20;
  transition: background 0.2s ease;
}
button.dismiss:hover {
  background-color: var(--color-contrast);
}
menu {
  width: 100%;
  display: inline-block;
  list-style-type: none;
  margin-block-start: 0;
  margin-block-end: 0;
  padding-inline-start: 0;
  margin-bottom: -18px;
}
menu .darkswitch {
  display: block;
  height: 9px;
  position: relative;
  width: 9px;
  float: right;
}
menu .darkswitch .sun {
  position: absolute;
  left: -6px;
  top: -6px;
  font-size: 21px;
  z-index: 1;
  color: var(--color-soft);
}
menu .darkswitch input {
  display: none;
}
menu .darkswitch .slider {
  background: var(--color-soft);
  bottom: 0;
  cursor: pointer;
  left: 0;
  position: absolute;
  right: 0;
  top: 0;
  transition: 0.2s ease;
  border-radius: 30px;
  z-index: 2;
}
menu .darkswitch .slider:before {
  top: -3px;
  content: "";
  height: 15px;
  left: -20px;
  position: absolute;
  transition: 0.2s ease;
  width: 15px;
  border-radius: 30px;
  background: var(--color-bkgd);
  z-index: 3;
}
menu .darkswitch input:checked + .slider {
  transform: scale(2.2);
}
menu .darkswitch input:checked + .slider:before {
  transform: translateX(14px) scale(0.5);
}
.nextprev-btn {
  background: transparent;
  border: none;
  position: fixed;
  top: 122px;
  color: var(--color-soft);
  font-size: 24px;
}
.nextprev-btn#prevch {
  left: 10px;
}
.nextprev-btn#nextch {
  right: 10px;
}
body {
  background-color: var(--color-bkgd);
  transition: 0.2s ease;
  overflow: scroll;
}
#container {
  
  width: 100%;
}
#container article {
  padding: 60px;
  max-width: 740px;
  margin: 40px auto;
  background-color: var(--color-bkgd);
  font-size: 16px;
  line-height: 32px;
  color: var(--color-main);
  font-family: "Work Sans", sans-serif;
  font-weight: 300;
  transition: 0.2s ease;
  min-height: 100vh;
}
#container article .centerwrap {
  display: flex;
  justify-content: center;
  align-items: center;
  
}
#container article h1 {
  font-family: "Lora";
  font-size: 2.5em;
  background-color: transparent;
  padding: 0 0.3em;
  line-height: 2em;
  border-bottom: 1px solid var(--color-main);
  margin: 1em 0 0;
  cursor: pointer;
  transition: 0.2s ease;
}
#container article h1:hover {
  background-color: var(--color-accent);
  color: var(--color-contrast);
  border-bottom: 1px solid var(--color-contrast);
}
#container article h2 {
  font-family: "Work Sans";
  font-size: 1.5em;
  font-weight: 700;
  color: var(--color-main);
  padding: 0 18px;
  line-height: 2em;
  cursor: pointer;
  transition: 0.2s ease;
}
#container article h2:hover {
  background-color: var(--color-accent);
}
#container article .verse {
  top: -0.5em;
  position: relative;
  font-size: 0.6em;
  font-family: "Work Sans";
  font-weight: 500;
  color: var(--color-soft);
  line-height: 1;
}
#container article .verse:before {
  content: " ";
}
#container article p {
  margin-top: 1em;
}
#container article p b {
  font-weight: inherit;
}
a[target="_blank"] {
  display: block;
  text-align: center;
  color: var(--color-soft);
  text-decoration: none;
  font-size: 1em;
  margin-top: 20px;
}
@media (max-width: 900px) {
  article {
    padding: 30px !important;
    margin: 20px auto !important;
    font-size: 14px !important;
    line-height: 28px !important;
  }
}
.highlight {
  background-color: yellow;
  color: black;
  font-weight: bold;
}

</style>
</head>
<body>
<!-- partial:index.partial.html -->
<!--
TO DO
-Functionality to search for a word and load the results (word search)
-Add a commentary section that has access to public domain commentaries
-Add a dictionary section with access to public domain dictionaries
-Add a subject search, a word will link other verses of a similar topic
-Access to public domain verses by subject
-Make this the best all around Bible study tool possible
  - Overall clean up the JS
  - Navigation to next/prev chapters
  - Do an accessibility/WCAG sweep
  - Add other translations
  - Fine-tune mobile breakpoints
-->

     
</div>
<div id="container">
  <article>
    <button class="dismiss">
      <ion-icon name="close-outline"></ion-icon>
    </button>
    <menu>
      <label class="darkswitch" for="checkbox">
        <input type="checkbox" id="checkbox" />
        <div class="slider"></div>
        <ion-icon name="sunny" class="sun"></ion-icon>
      </label>
    </menu>
    <nav class="centerwrap" id="booknav">
      <h1 id="book"></h1>
      <ul id="bookselect"></ul>
    </nav>
    <nav class="centerwrap" id="chapternav">
      <h2 id="chapter"></h2>
      <ul id="chapterselect">
      </ul>
    </nav>
    <p id="passage"></p>
    <div style="text-align: center;">
      <h1>BIBLE SEARCH</h1>
    <input style="border-radius: 25px;" type="text" id="searchInput">
<button style="border-radius: 5px;" id="searchButton">Search</button>
<div id="searchResults"></div>
  </div>
  </article>
  
  
</div>



<script src="main.js"></script>
<!-- partial -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
  
<script>
 let bible;  // Make sure bible is globally defined

// Fetch the Bible JSON file
fetch('./en_kjv.json')
  .then(response => response.json())
  .then(data => {
    bible = data;  // Load the Bible data into the global variable
    console.log('Bible data loaded:', bible);
  })
  .catch(error => console.error('Error loading the JSON:', error));

// Function to highlight the search term
function highlightSearchTerm(text, searchTerm) {
  const regex = new RegExp(`(^|\\W)${searchTerm}(\\W|$)`, 'gi');
  return text.replace(regex, '$1<mark class="highlight">$&</mark>$2');
}

// Add event listener to the search button
searchButton.addEventListener('click', () => {
  if (!bible) {
    alert('Bible data is still loading, please wait.');
    return;
  }

  const query = searchInput.value.trim().toLowerCase(); // Trim and convert to lower case
  searchResults.innerHTML = '';  // Clear previous results

  let resultsFound = 0;

  // Iterate over the books in the Bible JSON
  bible.forEach(book => {
    if (Array.isArray(book.chapters)) {
      book.chapters.forEach((chapter, chapterIndex) => {
        if (Array.isArray(chapter)) {
          chapter.forEach((verse, verseIndex) => {
            if (verse.toLowerCase().includes(query)) {
              // Highlight the search term and display the result
              const highlightedVerse = highlightSearchTerm(verse, query);
              searchResults.innerHTML += `
                <p>
                  <strong>${book.name} ${chapterIndex + 1}:${verseIndex + 1} (KJV)</strong> - 
                  ${highlightedVerse}
                </p>`;
              resultsFound++;
            }
          });
        }
      });
    }
  });

  console.log('Results found:', resultsFound);

  if (resultsFound === 0) {
    searchResults.innerHTML = '<p>No results found.</p>';
  }
});

// CSS for highlighting
const style = document.createElement('style');
style.innerHTML = `
.highlight {
  background-color: yellow;
}
`;
document.head.appendChild(style);



</script>

  <script  src="./script.js">

const toggleSwitch = document.querySelector(
  '.darkswitch input[type="checkbox"]'
);
const currentTheme = localStorage.getItem("theme");

if (currentTheme) {
  document.documentElement.setAttribute("data-theme", currentTheme);
  if (currentTheme === "dark") {
    toggleSwitch.checked = true;
  }
}

function switchTheme(e) {
  if (e.target.checked) {
    document.documentElement.setAttribute("data-theme", "dark");
    localStorage.setItem("theme", "dark");
  } else {
    document.documentElement.setAttribute("data-theme", "light");
    localStorage.setItem("theme", "light");
  }
}

toggleSwitch.addEventListener("change", switchTheme, false);

// The NET translation API (labs.bible.org/api) currently used doesn't provide all the needed metadata, so some supplemental JSON is added here
var biblemeta = {
  data: {
    gen: {
      booknum: "1",
      title: "Genesis",
      abbr: "Gen",
      chapters: "50"
    },
    exo: {
      booknum: "2",
      title: "Exodus",
      abbr: "Exo",
      chapters: "40"
    },
    lev: {
      booknum: "3",
      title: "Leviticus",
      abbr: "Lev",
      chapters: "27"
    },
    num: {
      booknum: "4",
      title: "Numbers",
      abbr: "Num",
      chapters: "36"
    },
    deut: {
      booknum: "5",
      title: "Deuteronomy",
      abbr: "Deut",
      chapters: "34"
    },
    josh: {
      booknum: "6",
      title: "Joshua",
      abbr: "Josh",
      chapters: "24"
    },
    judg: {
      booknum: "7",
      title: "Judges",
      abbr: "Judg",
      chapters: "21"
    },
    ruth: {
      booknum: "8",
      title: "Ruth",
      abbr: "Ruth",
      chapters: "4"
    },
    "1sam": {
      booknum: "9",
      title: "1 Samuel",
      abbr: "1Sam",
      chapters: "31"
    },
    "2sam": {
      booknum: "10",
      title: "2 Samuel",
      abbr: "2Sam",
      chapters: "24"
    },
    "1kgs": {
      booknum: "11",
      title: "1 Kings",
      abbr: "1Kings",
      chapters: "22"
    },
    "2kgs": {
      booknum: "12",
      title: "2 Kings",
      abbr: "2Kings",
      chapters: "25"
    },
    "1chr": {
      booknum: "13",
      title: "1 Chronicles",
      abbr: "1Chr",
      chapters: "29"
    },
    "2chr": {
      booknum: "14",
      title: "2 Chronicles",
      abbr: "2Chr",
      chapters: "36"
    },
    ezra: {
      booknum: "15",
      title: "Ezra",
      abbr: "Ezra",
      chapters: "10"
    },
    neh: {
      booknum: "16",
      title: "Nehemiah",
      abbr: "Neh",
      chapters: "13"
    },
    est: {
      booknum: "17",
      title: "Esther",
      abbr: "Est",
      chapters: "10"
    },
    job: {
      booknum: "18",
      title: "Job",
      abbr: "Job",
      chapters: "42"
    },
    ps: {
      booknum: "19",
      title: "Psalms",
      abbr: "Ps",
      chapters: "150"
    },
    pro: {
      booknum: "20",
      title: "Proverbs",
      abbr: "Pro",
      chapters: "31"
    },
    ecc: {
      booknum: "21",
      title: "Ecclesiastes",
      abbr: "Ecc",
      chapters: "12"
    },
    sos: {
      booknum: "22",
      title: "Song of Solomon",
      abbr: "Sos",
      chapters: "8"
    },
    isa: {
      booknum: "23",
      title: "Isaiah",
      abbr: "Isa",
      chapters: "66"
    },
    jer: {
      booknum: "24",
      title: "Jeremiah",
      abbr: "Jer",
      chapters: "52"
    },
    lam: {
      booknum: "25",
      title: "Lamentations",
      abbr: "Lam",
      chapters: "5"
    },
    eze: {
      booknum: "26",
      title: "Ezekiel",
      abbr: "Eze",
      chapters: "48"
    },
    dan: {
      booknum: "27",
      title: "Daniel",
      abbr: "Dan",
      chapters: "12"
    },
    hos: {
      booknum: "28",
      title: "Hosea",
      abbr: "Hos",
      chapters: "14"
    },
    joel: {
      booknum: "29",
      title: "Joel",
      abbr: "Joel",
      chapters: "3"
    },
    amos: {
      booknum: "30",
      title: "Amos",
      abbr: "Amos",
      chapters: "9"
    },
    oba: {
      booknum: "31",
      title: "Obadiah",
      abbr: "Oba",
      chapters: "1"
    },
    jonah: {
      booknum: "32",
      title: "Jonah",
      abbr: "Jonah",
      chapters: "4"
    },
    micah: {
      booknum: "33",
      title: "Micah",
      abbr: "Micah",
      chapters: "7"
    },
    nahum: {
      booknum: "34",
      title: "Nahum",
      abbr: "Nahum",
      chapters: "3"
    },
    hab: {
      booknum: "35",
      title: "Habakkuk",
      abbr: "Hab",
      chapters: "3"
    },
    zeph: {
      booknum: "36",
      title: "Zephaniah",
      abbr: "Zeph",
      chapters: "3"
    },
    hag: {
      booknum: "37",
      title: "Haggai",
      abbr: "Hag",
      chapters: "2"
    },
    zech: {
      booknum: "38",
      title: "Zechariah",
      abbr: "Zech",
      chapters: "14"
    },
    mal: {
      booknum: "39",
      title: "Malachi",
      abbr: "Mal",
      chapters: "4"
    },
    matt: {
      booknum: "40",
      title: "Matthew",
      abbr: "Matt",
      chapters: "28"
    },
    mark: {
      booknum: "41",
      title: "Mark",
      abbr: "Mark",
      chapters: "16"
    },
    luke: {
      booknum: "42",
      title: "Luke",
      abbr: "Luke",
      chapters: "24"
    },
    john: {
      booknum: "43",
      title: "John",
      abbr: "John",
      chapters: "21"
    },
    acts: {
      booknum: "44",
      title: "Acts",
      abbr: "Acts",
      chapters: "28"
    },
    rom: {
      booknum: "45",
      title: "Romans",
      abbr: "Rom",
      chapters: "16"
    },
    "1cor": {
      booknum: "46",
      title: "1 Corinthians",
      abbr: "1Cor",
      chapters: "16"
    },
    "2cor": {
      booknum: "47",
      title: "2 Corinthians",
      abbr: "2Cor",
      chapters: "13"
    },
    gal: {
      booknum: "48",
      title: "Galatians",
      abbr: "Gal",
      chapters: "6"
    },
    eph: {
      booknum: "49",
      title: "Ephesians",
      abbr: "Eph",
      chapters: "6"
    },
    phil: {
      booknum: "50",
      title: "Philippians",
      abbr: "Phil",
      chapters: "4"
    },
    col: {
      booknum: "51",
      title: "Colossians",
      abbr: "Col",
      chapters: "4"
    },
    "1the": {
      booknum: "52",
      title: "1 Thessalonians",
      abbr: "1The",
      chapters: "5"
    },
    "2the": {
      booknum: "53",
      title: "2 Thessalonians",
      abbr: "2The",
      chapters: "3"
    },
    "1tim": {
      booknum: "54",
      title: "1 Timothy",
      abbr: "1Tim",
      chapters: "6"
    },
    "2tim": {
      booknum: "55",
      title: "2 Timothy",
      abbr: "2Tim",
      chapters: "4"
    },
    titus: {
      booknum: "56",
      title: "Titus",
      abbr: "Titus",
      chapters: "3"
    },
    phile: {
      booknum: "57",
      title: "Philemon",
      abbr: "Phile",
      chapters: "1"
    },
    heb: {
      booknum: "58",
      title: "Hebrews",
      abbr: "Heb",
      chapters: "13"
    },
    james: {
      booknum: "59",
      title: "James",
      abbr: "James",
      chapters: "5"
    },
    "1pet": {
      booknum: "60",
      title: "1 Peter",
      abbr: "1Pet",
      chapters: "5"
    },
    "2pet": {
      booknum: "61",
      title: "2 Peter",
      abbr: "2Pet",
      chapters: "3"
    },
    "1jn": {
      booknum: "62",
      title: "1 John",
      abbr: "1Jn",
      chapters: "5"
    },
    "2jn": {
      booknum: "63",
      title: "2 John",
      abbr: "2Jn",
      chapters: "1"
    },
    "3jn": {
      booknum: "64",
      title: "3 John",
      abbr: "3Jn",
      chapters: "1"
    },
    jude: {
      booknum: "65",
      title: "Jude",
      abbr: "Jude",
      chapters: "1"
    },
    rev: {
      booknum: "66",
      title: "Revelation",
      abbr: "Rev",
      chapters: "22"
    }
  }
};

$(document).ready(function () {
  // Have variables start out with Genesis 1
  var bkselect = "Gen";
  var bk = "Genesis";
  var chselect = "1";
  var ch = "1";
  var curcount = "50";
  var url =
    "https://labs.bible.org/api/?passage=" +
    bkselect +
    "%20" +
    chselect +
    "&type=json&callback=?";

  // Populate the book selector with book titles...
  $.each(biblemeta.data, function (i, v) {
    if (v.abbr == bkselect) {
      curcount = v.chapters;
      bk = v.title;
    }
    $("#bookselect").append(
      "<li class='bookitem' data='" + v.abbr + "'>" + v.title + "</li>"
    );
  });

  // ...and the chapter selector with the right number of chapters
  $(function () {
    for (var i = 1; i <= curcount; i++) {
      $("#chapterselect").append(
        "<li class='chapteritem' data='" + i + "'>" + i + "</li>"
      );
    }
  });

  // Load the chapter text from API
  $.getJSON(url, function (json) {
    $("#book").text(bk);
    $("#chapter").text(chselect);
    $.each(json, function () {
      $("#passage").append(
        '<sup class="verse">' + this.verse + "</sup>" + this.text
      );
    });
  });

  // Toggle on book selector when book title is clicked
  $("#book").click(function () {
    $("#bookselect").fadeIn();
    $(".dismiss").slideDown();
  });

  // and off when dismiss button is clicked. Apply to chapter selector as well
  $(".dismiss").click(function () {
    $("#bookselect").fadeOut();
    $("#chapterselect").fadeOut();
    $(".dismiss").slideUp();
  });

  // When a book is selected, update variables and refresh passage with new content

  $("body").on("click", ".bookitem", function (event) {
    $("#bookselect").fadeOut();
    $(".dismiss").slideUp();

    bkselect = jQuery(this).attr("data");
    $.each(biblemeta.data, function (i, v) {
      if (v.abbr == bkselect) {
        curcount = v.chapters;
        bk = v.title;
        chselect = 1;
      }
    });

    url =
      "https://labs.bible.org/api/?passage=" +
      bkselect +
      "%20" +
      chselect +
      "&type=json&callback=?";

    $(function () {
      if ($("#chapterselect").length > 0) {
        $("#chapterselect").empty();
        for (var i = 1; i <= curcount; i++) {
          $("#chapterselect").append(
            "<li class='chapteritem' data='" + i + "'>" + i + "</li>"
          );
        }
      }
    });

    $.getJSON(url, function (json) {
      bk = json[0].bookname;
      ch = json[0].chapter;
      $("#book").text(bk);
      $("#chapter").text(ch);
      if ($("#passage").length > 0) {
        $("#passage").empty();
        $.each(json, function () {
          $("#passage").append(
            '<sup class="verse">' + this.verse + "</sup>" + this.text
          );
        });
      }
    });
  });

  // Toggle chapter selector when chapter number is clicked
  $("#chapter").click(function () {
    $("#chapterselect").fadeIn();
    $(".dismiss").slideDown();
  });

  // When a chapter is selected, update variables and refresh passage with new content
  $("body").on("click", ".chapteritem", function (event) {
    $("#chapterselect").fadeOut();
    $(".dismiss").slideUp();

    chselect = jQuery(this).attr("data");

    url =
      "https://labs.bible.org/api/?passage=" +
      bkselect +
      "%20" +
      chselect +
      "&type=json&callback=?";

    $.getJSON(url, function (json) {
      bk = json[0].bookname;
      ch = json[0].chapter;
      $("#book").text(bk);
      $("#chapter").text(ch);
      if ($("#passage").length > 0) {
        $("#passage").empty();
        $.each(json, function () {
          $("#passage").append(
            '<sup class="verse">' + this.verse + "</sup>" + this.text
          );
        });
      }
    });
  });
});
  </script>

</body>
</html>
